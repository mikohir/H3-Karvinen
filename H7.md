# H7 - Oma moduli

Seitsemäs ja viimeinen harjoitus Karvisen [palvelinten hallinta](https://terokarvinen.com/2021/configuration-management-systems-palvelinten-hallinta-ict4tn022-spring-2021/#h3-versionhallinta) -kurssilta.


#### a) Kaikki läksyt. Laita tähän linkki jokaiseen kotitehtäväraporttiisi.

H1: [https://mikohirvela.wordpress.com/](https://mikohirvela.wordpress.com/)

H2: [https://mikohirvela.wordpress.com/harjoitus-2/](https://mikohirvela.wordpress.com/harjoitus-2/)

H3: [https://github.com/mikohir/Palvelinten-hallinta/blob/main/H3.md](https://github.com/mikohir/Palvelinten-hallinta/blob/main/H3.md)

H4: [https://github.com/mikohir/Palvelinten-hallinta/blob/main/H4.md](https://github.com/mikohir/Palvelinten-hallinta/blob/main/H4.md)

H5: [https://github.com/mikohir/Palvelinten-hallinta/blob/main/H5.md](https://github.com/mikohir/Palvelinten-hallinta/blob/main/H5.md)

H6: [https://github.com/mikohir/Palvelinten-hallinta/blob/main/H6.md](https://github.com/mikohir/Palvelinten-hallinta/blob/main/H6.md)


#### b) Oma moduli (iso tehtävä). Ratkaise jokin oikean elämän tai keksitty tarve omilla tiloilla/moduleilla. Voit käyttää Salttia tai muuta valitsemaasi modernia keskitetyn hallinnan ohjelmaa. Esitä tulos viimeisellä opetuskerralla, 5-10 min. Live demo olisi kiva.


Päätin omaksi moduliksi luoda uuden virtuaalisen orjakoneen Xubuntulla, jolle asennan saltilla master -virtuaalikoneelta käsin Visual Boy Advanced -emulaattorin, sekä lataan sille pelitiedoston (ROM). Luodakseni hieman haastetta, haluan konfiguroida sellaisen tilan, joka asentaa xubuntu ja ubuntu orjille näiden nimien perusteella eri pelitiedoston (ja VBA:n). VBA:n asetuksia on tarkoitus myös muuttaa sen asennuksen yhteydessä uusille koneille tilaa ajamalla (näppäin -asetukset omaan makuun, sekä toimivuuden kannalta oleelliset muut konfiguraatiot).

Lähdin liikkeelle asentamalla uuden virtuaalikoneen Xubuntulla (18.04.5) sekä tekemällä siitä orjan, jota varten kertasin Karvisen [artikkelin](https://terokarvinen.com//2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/) herra-orja -arkkitehtuurista muistini virkistämiseksi. Tässä kohtaa ongelmaksi esiintyi se, että herra ei saanut vastaanotettua orjan avainta (tai edes nähnyt sitä). Tarkistin orjan asetustiedostosta, että herran ip-osoite oli oikea, ja olihan se. Herran puolellakaan ei ollut vikaa, sillä aiempi orja (joka on samassa virtuaalikoneessa kuin itse herra) toimi normaalisti. Näin ollen päättelin, että vika on oltava verkkoyhteydessä tai johonkin siihen liittyvässä seikassa. Molemmat virtuaalikoneet saivat kuitenkin yhteyden internettiin ja toimivat normaalisti, joten vika vika ei ollut suoraan siinäkään. Lopulta muistin, että virtualboxin verkkoasetukset voivat luoda tämän kaltaisia ongelmia. Näinpä kokeilin eri asetuksia, ja lopulta sain uuden orjan avaimen vastaanotettua. Jouduin vaihtamaan virtualboxin asetukset seuraavanlaisiksi:

![image](https://user-images.githubusercontent.com/82265726/118462572-7d504a00-b707-11eb-95fe-4565cfee5813.png)

Nyt molemmat orjat myös vastaavat herralle: 

![image](https://user-images.githubusercontent.com/82265726/118462925-dd46f080-b707-11eb-93e0-d4651f7aa3fb.png)

Seuraavana vaiheena VGA:n asennus manuaalisesti herralle, sekä sen asetusten muokkaus GUI:n kautta, jotta saan sen oikeat asetustiedostot selville aikajanan kautta ja täten kopioitua ne ajettavaa tilaa varten salt -kansioon.

Asensin aluksi visualboyadvance -paketin terminaalin kautta, mutta kyseinen versio antoi vain valkoista kuvaa, kun sillä yritti avata pelitiedostoa, eikä sen GUI:ssa ollut emulaattorin omia asetuksia. Näin ollen etsin ubuntun omasta tarjonnasta päivitetymmän version, [visualboyadvance-m](https://github.com/visualboyadvance-m/visualboyadvance-m):n, jolla asetukset tulivat haluttuun tapaan näkyviin emulaattoriin:

![image](https://user-images.githubusercontent.com/82265726/118475969-9a8c1500-b715-11eb-9d05-3f3420068b5b.png)

Tämän jälkeen ongelma oli se, että pelitiedostoa lukiessa emulaattori kaatui ja antoi seuraavanlaisen virhekoodin:

![image](https://user-images.githubusercontent.com/82265726/118482085-f017f000-b71c-11eb-97dc-79d4a0ba9159.png)

Pitkän päänsäryn jälkeen löysin [ratkaisun](https://github.com/visualboyadvance-m/visualboyadvance-m/issues/766) kyseiseen virhekoodiin. Piti vaihtaa emulaattorin videon ulostulon asetus yksinkertaiseksi (simple) ja taustalla näkyykin yksi valitsemani testipeli, eli Pokemon Emerald:

![image](https://user-images.githubusercontent.com/82265726/118481454-2d2fb280-b71c-11eb-9a52-ffaf00a40774.png)

Ensimmäinen peli toimii, joten vielä toisen ROMin testaus, ennen kuin vaihdellaan muita asetuksia ja aloitetaan tilan luonti. Toisena pelinä lataan [Pokemon Fire Redin](https://www.emulatorgames.net/roms/gameboy-advance/pokemon-fire-red-version-v11/). Tässä vielä kuva sen toimivuuden testauksesta:

![image](https://user-images.githubusercontent.com/82265726/118484131-8cdb8d00-b71f-11eb-9f10-1f331cb7ea1c.png)

Seuraavaksi oletusnäppäinasetusten muuttaminen ja konffitiedostojen metsästys aikajanalta muutosten tekemisen jälkeen. Tässä muuttamani asetukset ja kuva aikajanasta:

![image](https://user-images.githubusercontent.com/82265726/118488585-8bf92a00-b724-11eb-833b-797f4d03bbae.png)

![image](https://user-images.githubusercontent.com/82265726/118489292-59036600-b725-11eb-872c-e33e89b5c6c5.png)

Vbam.ini on siis etsimäni tiedosto. Luon salttiin VBA:lle oman kansion ja kopioin muokkaamani vbam.ini tiedoston sinne:



#### Lähteet:

VBA. Wikipedia.com, 2021. Luettavissa: [https://en.wikipedia.org/wiki/VisualBoyAdvance](https://en.wikipedia.org/wiki/VisualBoyAdvance). Luettu: 16.5.2021.

VBA-m. Github.com/visualboyadvance-m, 2021. Luettavissa: [https://github.com/visualboyadvance-m/visualboyadvance-m](https://github.com/visualboyadvance-m/visualboyadvance-m). Luettu 17.5.2021.

Emulaattorin virhekoodin korjaus. Github.com/visualboyadvance-m, 2020. Luettavissa: [https://github.com/visualboyadvance-m/visualboyadvance-m/issues/766](https://github.com/visualboyadvance-m/visualboyadvance-m/issues/766). Luettu 17.5.2021.

Pokemon emerald ROM. Emulatorgames.com. Ladattavissa: [https://www.emulatorgames.net/roms/gameboy-advance/pokemon-emerald-version/](https://www.emulatorgames.net/roms/gameboy-advance/pokemon-emerald-version/). Ladattu 17.5.2021.

Pokemon Fire Red ROM. Emulatorgames.com. Ladattavissa: [https://www.emulatorgames.net/roms/gameboy-advance/pokemon-fire-red-version-v11/](https://www.emulatorgames.net/roms/gameboy-advance/pokemon-fire-red-version-v11/). Ladattu 17.5.2021.

Salt master-minion. Tero Karvinen, 2018. Luettavissa: [https://terokarvinen.com//2015/salt-master-minion-with-ubuntu-14-04-lts-control-your-slaves-over-the-internet/index.html](https://terokarvinen.com//2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/). Luettu 16.5.2021.

